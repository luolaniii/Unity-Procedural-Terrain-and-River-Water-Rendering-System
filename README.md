# Unity ç¨‹åºåŒ–åœ°å½¢ä¸æ²³æµæ°´æ¸²æŸ“ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Unityé¡¹ç›®ï¼Œå®ç°äº†å®Œæ•´çš„ç¨‹åºåŒ–åœ°å½¢ç”Ÿæˆã€ä¾µèš€æ¨¡æ‹Ÿå’Œæ²³æµæ°´æ¸²æŸ“ç³»ç»Ÿã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„ç¨‹åºåŒ–åœ°å½¢ç”Ÿæˆå’Œæ²³æµæ°´æ¸²æŸ“è§£å†³æ–¹æ¡ˆï¼ŒåŒ…å«ï¼š

- **ç¨‹åºåŒ–åœ°å½¢ç”Ÿæˆ**ï¼šåŸºäºå™ªå£°çš„å¤šå±‚åœ°å½¢ç”Ÿæˆç³»ç»Ÿ
- **ä¾µèš€æ¨¡æ‹Ÿ**ï¼šCPUå’ŒGPUåŠ é€Ÿçš„åœ°å½¢ä¾µèš€ç®—æ³•
- **æ²³æµç³»ç»Ÿ**ï¼šç¨‹åºåŒ–æ²³æµç”Ÿæˆï¼Œæ”¯æŒè‡ªåŠ¨åœ°å½¢ä¿®æ”¹
- **æ°´æ¸²æŸ“**ï¼šé«˜è´¨é‡çš„æ°´ä½“æ¸²æŸ“å’Œæµ®åŠ›ç‰©ç†ç³»ç»Ÿ
- **åœ°å½¢ç»˜åˆ¶å·¥å…·**ï¼šç›´è§‚çš„åœ°å½¢çº¹ç†ç»˜åˆ¶å’Œç»†èŠ‚ç®¡ç†

## âœ¨ ä¸»è¦åŠŸèƒ½

### ğŸ”ï¸ ç¨‹åºåŒ–åœ°å½¢ç³»ç»Ÿ

#### åœ°å½¢ç”Ÿæˆ (`Assets/Terrain/Scripts/`)
- **TRN_Generator**: ä¸»åœ°å½¢ç”Ÿæˆå™¨ï¼Œæ”¯æŒå¤šå±‚å™ªå£°å åŠ 
- **TRN_Noise**: å¤šç§å™ªå£°ç®—æ³•ï¼ˆPerlin, Simplexç­‰ï¼‰
- **TRNGen_Heightmap**: é«˜åº¦å›¾ç”Ÿæˆå·¥å…·
- **TRN_Filters**: åœ°å½¢åå¤„ç†è¿‡æ»¤å™¨

#### ä¾µèš€æ¨¡æ‹Ÿ
- **TRN_Erosion**: CPUåŸºç¡€çš„ä¾µèš€ç®—æ³•
- **EDEN_ErosionTools**: GPUåŠ é€Ÿçš„ä¾µèš€ç³»ç»Ÿ
  - æ°´åŠ›ä¾µèš€æ¨¡æ‹Ÿ
  - æ²‰ç§¯ç‰©å±‚ç®¡ç†
  - å¹³æ»‘å’Œé”åŒ–å¤„ç†
  - é£åŠ›ä¾µèš€æ•ˆæœ

#### åœ°å½¢ç»˜åˆ¶
- **EDEN_Terrain_Painter**: å¯è§†åŒ–åœ°å½¢çº¹ç†ç»˜åˆ¶å·¥å…·
- æ”¯æŒå¤šç§åœ°å½¢å±‚ï¼ˆè‰åœ°ã€å²©çŸ³ã€æ²™åœ°ã€é›ªåœ°ç­‰ï¼‰
- çº¹ç†é…ç½®æ–‡ä»¶ç³»ç»Ÿ

### ğŸŒŠ æ²³æµæ°´æ¸²æŸ“ç³»ç»Ÿ

#### æ²³æµç”Ÿæˆ (`Assets/River/Scripts/`)
- **River**: æ ¸å¿ƒæ²³æµç”Ÿæˆç»„ä»¶
  - åŸºäºè·¯å¾„ç‚¹çš„ç¨‹åºåŒ–æ²³æµç”Ÿæˆ
  - å¯é…ç½®çš„æ²³æµå®½åº¦ã€æ·±åº¦å’Œå¼¯æ›²åº¦
  - è‡ªåŠ¨åœ°å½¢ä¿®æ”¹åŠŸèƒ½
  - æ²³åºŠå¹³æ»‘å¤„ç†
  - æ”¯æŒé«˜åº¦å›¾é‡‡æ ·
- **RiverInstance**: æ²³æµå®ä¾‹ç®¡ç†
- **RiverDraw**: ç¼–è¾‘å™¨å¯è§†åŒ–å·¥å…·

#### æ°´ç‰©ç†ç³»ç»Ÿ
- **MyWaterVolume**: æ°´ä½“ç§¯å’Œå¯†åº¦ç®¡ç†
- **MyFloatObject**: æµ®åŠ›ç‰©ç†å¯¹è±¡
- **NaughtyWaterBuoyancyUtils**: æµ®åŠ›è®¡ç®—å·¥å…·
- **SimpleSpawer**: ç®€å•ç”Ÿæˆå™¨å·¥å…·

#### æ¸²æŸ“
- **River.shader**: æ²³æµç€è‰²å™¨
- **RiverWater.shader**: æ°´ä½“æ¸²æŸ“ç€è‰²å™¨
- æ”¯æŒURPæ¸²æŸ“ç®¡çº¿

### ğŸ› ï¸ è¾…åŠ©å·¥å…·

#### Vertex Picker (`Assets/Vertex Picker/`)
- ç²¾ç¡®çš„é¡¶ç‚¹åæ ‡è·å–å·¥å…·
- æ”¯æŒç²¾ç¡®äº¤ç‚¹å’Œæœ€è¿‘é¡¶ç‚¹ä¸¤ç§æ¨¡å¼
- å¯è§†åŒ–åé¦ˆ
- è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜è¯·å‚è€ƒ `Assets/Vertex Picker/README.md`

#### Material Parameter Tool (`Assets/MaterialParameterTool/`)
- æè´¨å‚æ•°æŸ¥æ‰¾å’Œç®¡ç†å·¥å…·
- ç¼–è¾‘å™¨çª—å£ç•Œé¢

#### åœ°å½¢å·¥å…·
- **TerrainHeightmapExporterUtility**: åœ°å½¢é«˜åº¦å›¾å¯¼å‡ºå·¥å…·

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Unityç‰ˆæœ¬**: 2023.2.20f1 æˆ–æ›´é«˜
- **æ¸²æŸ“ç®¡çº¿**: Universal Render Pipeline (URP) 15.0.7
- **å¹³å°**: Windows, macOS, Linux

### å®‰è£…æ­¥éª¤

1. **å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®**
   ```bash
   git clone <repository-url>
   ```

2. **æ‰“å¼€Unityé¡¹ç›®**
   - ä½¿ç”¨Unity 2023.2.20f1æ‰“å¼€é¡¹ç›®
   - ç­‰å¾…Unityå¯¼å…¥æ‰€æœ‰èµ„æº

3. **ä¾èµ–åŒ…**
   é¡¹ç›®ä¼šè‡ªåŠ¨å®‰è£…ä»¥ä¸‹ä¾èµ–ï¼š
   - Universal Render Pipeline (URP) 15.0.7
   - Cinemachine 2.10.5
   - Unity Splines 2.7.2
   - Adobe Substance3D For Unity
   - MicroSplat Core

4. **æ‰“å¼€ç¤ºä¾‹åœºæ™¯**
   - `Assets/Scenes/SampleScene.unity` - ä¸»ç¤ºä¾‹åœºæ™¯

## ğŸ“– ä½¿ç”¨æŒ‡å—

### ç”Ÿæˆç¨‹åºåŒ–åœ°å½¢

1. åœ¨åœºæ™¯ä¸­åˆ›å»ºä¸€ä¸ªTerrainå¯¹è±¡
2. æ·»åŠ  `TRN_Generator` ç»„ä»¶
3. é…ç½®å™ªå£°å‚æ•°å’Œåœ°å½¢å°ºå¯¸
4. ç‚¹å‡»"Generate"æŒ‰é’®ç”Ÿæˆåœ°å½¢
5. ä½¿ç”¨ `TRN_Erosion` æˆ– `EDEN_ErosionTools` è¿›è¡Œä¾µèš€å¤„ç†

```csharp
// ç¤ºä¾‹ï¼šç”Ÿæˆåœ°å½¢
var generator = terrain.GetComponent<TRN_Generator>();
generator.Generate();

// è¿è¡Œä¾µèš€
var erosion = terrain.GetComponent<TRN_Erosion>();
erosion.Run();
```

### åˆ›å»ºæ²³æµ

1. åˆ›å»ºä¸€ä¸ªç©ºGameObject
2. æ·»åŠ  `River` ç»„ä»¶
3. é…ç½®æ²³æµå‚æ•°ï¼š
   - è®¾ç½®ç½‘æ ¼åˆ†è¾¨ç‡ (xSize, ySize)
   - é…ç½®æ²³æµå®½åº¦ã€æ·±åº¦
   - è®¾ç½®è·¯å¾„ç‚¹ (wayPoints)
   - æŒ‡å®šç›®æ ‡åœ°å½¢ (targetTerrain)
4. åœ¨ç¼–è¾‘å™¨ä¸­ç»˜åˆ¶æ²³æµè·¯å¾„
5. å¯ç”¨ `modifyRealTerrain` ä»¥ä¿®æ”¹å®é™…åœ°å½¢

```csharp
// ç¤ºä¾‹ï¼šé…ç½®æ²³æµ
var river = GetComponent<River>();
river.targetTerrain = myTerrain;
river.maxRiverWidth = 10f;
river.riverDepth = 2f;
river.modifyRealTerrain = true;
```

### åœ°å½¢ç»˜åˆ¶

1. é€‰æ‹©Terrainå¯¹è±¡
2. ä½¿ç”¨ `EDEN_Terrain_Painter` å·¥å…·
3. é€‰æ‹©ä¸åŒçš„åœ°å½¢çº¹ç†å±‚
4. åœ¨Sceneè§†å›¾ä¸­ç»˜åˆ¶

### GPUåŠ é€Ÿä¾µèš€

1. é€‰æ‹©Terrainå¯¹è±¡
2. æ·»åŠ  `EDEN_ErosionTools` ç»„ä»¶
3. é…ç½®ä¾µèš€å‚æ•°
4. è¿è¡ŒGPUä¾µèš€æ¨¡æ‹Ÿ

## ğŸ“ é¡¹ç›®ç»“æ„

```
Assets/
â”œâ”€â”€ Terrain/                    # åœ°å½¢ç³»ç»Ÿ
â”‚   â”œâ”€â”€ Scripts/
â”‚   â”‚   â”œâ”€â”€ TRN_Generator.cs    # åœ°å½¢ç”Ÿæˆå™¨
â”‚   â”‚   â”œâ”€â”€ TRN_Erosion.cs      # CPUä¾µèš€
â”‚   â”‚   â”œâ”€â”€ TRN_Noise.cs        # å™ªå£°ç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ GPU/                # GPUåŠ é€Ÿå·¥å…·
â”‚   â”‚   â”‚   â”œâ”€â”€ EDEN_ErosionTools.cs
â”‚   â”‚   â”‚   â””â”€â”€ ComputeShaders/ # Computeç€è‰²å™¨
â”‚   â”‚   â””â”€â”€ Editor/             # ç¼–è¾‘å™¨å·¥å…·
â”‚   â””â”€â”€ TerrainLayers/          # åœ°å½¢çº¹ç†å±‚
â”œâ”€â”€ River/                       # æ²³æµç³»ç»Ÿ
â”‚   â”œâ”€â”€ Scripts/
â”‚   â”‚   â”œâ”€â”€ River.cs            # æ²³æµç”Ÿæˆ
â”‚   â”‚   â”œâ”€â”€ MyWaterVolume.cs    # æ°´ä½“ç§¯
â”‚   â”‚   â”œâ”€â”€ RiverInstance.cs    # æ²³æµå®ä¾‹
â”‚   â”‚   â””â”€â”€ Editor/             # ç¼–è¾‘å™¨å·¥å…·
â”‚   â”œâ”€â”€ Shaders/                # ç€è‰²å™¨
â”‚   â””â”€â”€ Material/              # æè´¨
â”œâ”€â”€ Vertex Picker/              # é¡¶ç‚¹é€‰æ‹©å·¥å…·
â”œâ”€â”€ MaterialParameterTool/      # æè´¨å‚æ•°å·¥å…·
â”œâ”€â”€ Adobe/                      # Substance3Dé›†æˆ
â””â”€â”€ Scenes/                     # ç¤ºä¾‹åœºæ™¯
```

## âš™ï¸ æ ¸å¿ƒå‚æ•°è¯´æ˜

### åœ°å½¢ç”Ÿæˆå‚æ•°
- **width**: åœ°å½¢å®½åº¦
- **height**: åœ°å½¢æœ€å¤§é«˜åº¦
- **scale**: å™ªå£°ç¼©æ”¾
- **noise**: å™ªå£°å±‚é…ç½®
- **rivers**: æ˜¯å¦ç”Ÿæˆæ²³æµç‰¹å¾
- **beachHeight**: æµ·æ»©é«˜åº¦é˜ˆå€¼

### æ²³æµå‚æ•°
- **xSize/ySize**: ç½‘æ ¼åˆ†è¾¨ç‡
- **maxRiverWidth**: æœ€å¤§æ²³æµå®½åº¦
- **riverDepth**: æ²³æµæ·±åº¦
- **riverBedCurve**: æ²³åºŠå¼¯æ›²æ›²çº¿
- **wayPoints**: è·¯å¾„ç‚¹åˆ—è¡¨
- **modifyRealTerrain**: æ˜¯å¦ä¿®æ”¹çœŸå®åœ°å½¢
- **smoothRiverBed**: æ˜¯å¦å¹³æ»‘æ²³åºŠ

### ä¾µèš€å‚æ•°
- **iterations**: ä¾µèš€è¿­ä»£æ¬¡æ•°
- **massPerIteration**: æ¯æ¬¡è¿­ä»£çš„è´¨é‡
- **maxMass**: æœ€å¤§è´¨é‡

## ğŸ¨ èµ„æºè¯´æ˜

### åœ°å½¢çº¹ç†
é¡¹ç›®åŒ…å«å¤šç§åœ°å½¢çº¹ç†å±‚ï¼š
- è‰åœ° (Grass_A, Grass_B, Grass_Dry, Grass_Moss)
- å²©çŸ³ (Rock, Pebbles_A/B/C)
- æ²™åœ° (Sand, Black_Sand)
- åœŸå£¤ (Grass_Soil, Muddy, Soil_Rocks)
- é›ªåœ° (Snow)
- å…¶ä»– (Heather, Tidal_Pools)

### æ²³æµçº¹ç†
- æ²³åºŠçº¹ç† (pebble, stones)
- æ°´æ³•çº¿è´´å›¾
- æ°´é«˜åº¦è´´å›¾

### æ¤è¢«èµ„æº
- `Assets/Resourse/GrassFlowers/` - è‰åœ°å’ŒèŠ±æœµ
- `Assets/Resourse/Rocks and Vegetation Pack/` - å²©çŸ³å’Œæ¤è¢«

## ğŸ”§ æŠ€æœ¯ç‰¹æ€§

- **GPUåŠ é€Ÿ**: ä½¿ç”¨Compute Shadersè¿›è¡Œé«˜æ€§èƒ½ä¾µèš€æ¨¡æ‹Ÿ
- **ç¨‹åºåŒ–ç”Ÿæˆ**: åŸºäºå™ªå£°å’Œç®—æ³•çš„å®Œå…¨ç¨‹åºåŒ–åœ°å½¢
- **å®æ—¶ä¿®æ”¹**: æ²³æµç³»ç»Ÿå¯ä»¥å®æ—¶ä¿®æ”¹åœ°å½¢é«˜åº¦å›¾
- **ç‰©ç†æ¨¡æ‹Ÿ**: å®Œæ•´çš„æ°´ä½“æµ®åŠ›å’ŒæµåŠ¨ç‰©ç†
- **URPä¼˜åŒ–**: é’ˆå¯¹Universal Render Pipelineä¼˜åŒ–
- **ç¼–è¾‘å™¨å·¥å…·**: ä¸°å¯Œçš„å¯è§†åŒ–ç¼–è¾‘å™¨å·¥å…·

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **åœ°å½¢å¤‡ä»½**: å¯ç”¨ `autoBackupTerrain` ä»¥è‡ªåŠ¨å¤‡ä»½åœ°å½¢æ•°æ®
2. **æ€§èƒ½è€ƒè™‘**: é«˜åˆ†è¾¨ç‡åœ°å½¢å’Œå¤§é‡è¿­ä»£å¯èƒ½å½±å“æ€§èƒ½
3. **GPUä¾µèš€**: éœ€è¦æ”¯æŒCompute Shadersçš„æ˜¾å¡
4. **URPè®¾ç½®**: ç¡®ä¿é¡¹ç›®ä½¿ç”¨URPæ¸²æŸ“ç®¡çº¿
5. **Substance3D**: éƒ¨åˆ†æè´¨éœ€è¦Adobe Substance3Dæ’ä»¶
